<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/web/thymeleaf/layout" layout:decorate="~{mlayout}">
<!--  PAPER WRAP -->
<head>
    <meta charset="utf-8">
    <title>SearchUdata 1.0</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <!-- Le styles -->
    <script type="text/javascript" src="assets/js/jquery.2.1.1.js"></script>

    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="assets/css/loader-style.css">
    <link rel="stylesheet" href="assets/css/bootstrap.css">
    <link rel="stylesheet" href="assets/css/extra-pages.css">

    <link rel="stylesheet" href="assets/js/upload/demos/css/uploader.css">
    <link rel="stylesheet" href="assets/js/upload/demos/css/demo.css">

    <link rel="stylesheet" href="assets/js/dropZone/downloads/css/dropzone.css">

    <link rel="stylesheet" href="assets/js/tree/jquery.treeview.css">
    <link rel="stylesheet" href="../red-treeview.css">

    <link rel="stylesheet" href="assets/js/tree/treetable/stylesheets/jquery.treetable.css">
    <link rel="stylesheet" href="assets/js/tree/treetable/stylesheets/jquery.treetable.theme.default.css">

    <link href="assets/js/tree/tabelizer/tabelizer.min.css" media="all" rel="stylesheet" type="text/css">


    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!-- Fav and touch icons -->
    <link rel="shortcut icon" href="assets/ico/minus.png">
</head>

<div class="wrap-fluid" layout:fragment="ringhtcontent">
    <div class="container-fluid paper-wrap bevel tlbr">
        <!-- CONTENT -->
        <!--TITLE -->
        <div class="row">
            <div id="paper-top">
                <div class="col-sm-3">
                    <h2 class="tittle-content-header">
                        <i class="icon-view-list"></i>
                            <span>数据文件上传
                            </span>
                    </h2>

                </div>

                <div class="col-sm-7">
                    <div class="devider-vertical visible-lg"></div>
                    <div class="tittle-middle-header">

                        <div class="alert">
                            <button type="button" class="close" data-dismiss="alert">×</button>
                            <span class="tittle-alert entypo-info-circled"></span>
                            欢迎回来,&nbsp;
                            <strong>周翀!</strong>&nbsp;&nbsp;你最近登入的时间是 昨天下午, 16:54 PM
                        </div>


                    </div>

                </div>

            </div>
        </div>
        <!--/ TITLE -->

        <!-- BREADCRUMB -->
        <ul id="breadcrumb">
            <li>
                <span class="entypo-home"></span>
            </li>
            <li><i class="fa fa-lg fa-angle-right"></i>
            </li>
            <li><a href="#" title="Sample page 1">数据来源</a>
            </li>
            <li><i class="fa fa-lg fa-angle-right"></i>
            </li>
            <li><a href="#" title="Sample page 1">文件上传</a>
            </li>
            <li class="pull-right">
                <div class="input-group input-widget">

                    <!--input style="border-radius:15px" type="text" placeholder="Search..." class="form-control"-->


                </div>
            </li>
        </ul>

        <!-- END OF BREADCRUMB -->


        <div class="content-wrap">
            <div class="row">


                <div class="col-sm-12">
                    <div class="nest" id="DropZoneClose">
                        <div class="title-alt">
                            <h6>
                                请直接拖放或者单击选择要上传的文件</h6>
                            <div class="titleClose">
                                <a class="gone" href="#DropZoneClose">
                                    <span class="entypo-cancel"></span>
                                </a>
                            </div>
                            <div class="titleToggle">
                                <a class="nav-toggle-alt" href="#DropZone">
                                    <span class="entypo-up-open"></span>
                                </a>
                            </div>

                        </div>

                        <div class="body-nest" id="DropZone">

                            <form action="/upload" class="dropzone" id="myDropzone" method="post"></form>
                            <button style="margin-top:10px;" class="btn btn-info" id="submit-all">提交所有文件</button>


                        </div>
                    </div>
                </div>
            </div>
        </div>


        <div class="content-wrap">
            <div class="row">
                <div class="col-sm-12">

                    <div class="nest" id="tabletreeClose">
                        <div class="title-alt">
                            <h6>
                                文件上传管理（可任意拖放文件到指定的文件夹）</h6>
                            <div class="titleClose">
                                <a class="gone" href="#tabletreeClose">
                                    <span class="entypo-cancel"></span>
                                </a>
                            </div>
                            <div class="titleToggle">
                                <a class="nav-toggle-alt" href="#tabletree">
                                    <span class="entypo-up-open"></span>
                                </a>
                            </div>

                        </div>

                        <div class="body-nest" id="tabletree">

                            <a style="margin:0 0 10px;" href="#" class="pull-right btn btn-info"
                               onClick="jQuery('#example-advanced').treetable('expandAll'); return false;">全部展开</a>
                            <a style="margin:0 10px 10px; 0;" href="#" class="pull-right btn btn-info"
                               onClick="jQuery('#example-advanced').treetable('collapseAll'); return false;">全部折叠</a>

                            <table id="example-advanced" class="table-striped">


                                <thead>
                                <tr>
                                    <th>文件名</th>
                                    <th>大小</th>
                                    <th>操作</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr data-tt-id='0'>
                                    <td>
                                        <span class='folder'>CHUD</span>
                                    </td>
                                    <td>Folder</td>
                                    <td>&#45;&#45;</td>
                                </tr>
                                <!-- <tr data-tt-id='1'>
                                     <td>
                                         <span class='file'>Acknowledgements.rtf</span>
                                     </td>
                                     <td>File</td>
                                     <td>480.95 KB</td>
                                 </tr>
                                 <tr data-tt-id='2'>
                                     <td>
                                         <span class='folder'>CHUD</span>
                                     </td>
                                     <td>Folder</td>
                                     <td>&#45;&#45;</td>
                                 </tr>
                                 <tr data-tt-id='2-1' data-tt-parent-id='2'>
                                     <td>
                                         <span class='folder'>amber</span>
                                     </td>
                                     <td>Folder</td>
                                     <td>&#45;&#45;</td>
                                 </tr>
                                 <tr data-tt-id='2-1-1' data-tt-parent-id='2-1'>
                                     <td>
                                         <span class='file'>AmberTraceFormats.pdf</span>
                                     </td>
                                     <td>File</td>
                                     <td>124.46 KB</td>
                                 </tr>
                                 <tr data-tt-id='2-2' data-tt-parent-id='2'>
                                     <td>
                                         <span class='folder'>BigTop</span>
                                     </td>
                                     <td>Folder</td>
                                     <td>&#45;&#45;</td>
                                 </tr>
                                 <tr data-tt-id='2-2-1' data-tt-parent-id='2-2'>
                                     <td>
                                         <span class='file'>BigTopUserGuide.pdf</span>
                                     </td>
                                     <td>File</td>
                                     <td>1314.71 KB</td>
                                 </tr>
                                 <tr data-tt-id='2-3' data-tt-parent-id='2'>
                                     <td>
                                         <span class='folder'>Saturn</span>
                                     </td>
                                     <td>Folder</td>
                                     <td>&#45;&#45;</td>
                                 </tr>
                                 <tr data-tt-id='2-3-1' data-tt-parent-id='2-3'>
                                     <td>
                                         <span class='file'>SaturnUserGuide.pdf</span>
                                     </td>
                                     <td>File</td>
                                     <td>694.29 KB</td>
                                 </tr>
                                 <tr data-tt-id='2-4' data-tt-parent-id='2'>
                                     <td>
                                         <span class='folder'>Shark</span>
                                     </td>
                                     <td>Folder</td>
                                     <td>&#45;&#45;</td>
                                 </tr>
                                 <tr data-tt-id='2-4-1' data-tt-parent-id='2-4'>
                                     <td>
                                         <span class='file'>SharkUserGuide.pdf</span>
                                     </td>
                                     <td>File</td>
                                     <td>12902.51 KB</td>
                                 </tr>-->
                                </tbody>
                            </table>

                        </div>

                    </div>


                </div>
            </div>
        </div>

        <!---- -----------------------------------------------------------------------	>








        <!---- -----------------------------------------------------------------------	>
                    <!-- /END OF CONTENT -->


        <!-- FOOTER -->
        <div class="footer-space"></div>
        <div id="footer">
            <div class="devider-footer-left"></div>
            <div class="time">
                <p id="spanDate">
                <p id="clock">
            </div>
            <div class="copyright">技术支持
                <span class="entypo-heart"></span>Contact from <a href="index.html" title="SearchUdata DMP"
                                                                  target="_blank">umessage.com.cn</a> All Rights
                Reserved
            </div>
            <div class="devider-footer"></div>

        </div>
        <!-- / END OF FOOTER -->

    </div>
</div>
<!--  END OF PAPER WRAP -->


<div layout:fragment="ringhtfooter">
    <!-- MAIN EFFECT -->
    <script type="text/javascript" src="assets/js/preloader.js"></script>
    <script type="text/javascript" src="assets/js/bootstrap.js"></script>
    <script type="text/javascript" src="assets/js/app.js"></script>
    <script type="text/javascript" src="assets/js/load.js"></script>
    <script type="text/javascript" src="assets/js/main.js"></script>

    <script src="http://code.jquery.com/jquery-migrate-1.2.1.min.js"></script>

    <script type="text/javascript" src="assets/js/upload/demos/js/demo.min.js"></script>
    <script type="text/javascript" src="assets/js/upload/src/dmuploader.min.js"></script>


    <script src="assets/js/dropZone/lib/dropzone.js"></script>

    <script src="assets/js/tree/lib/jquery.cookie.js" type="text/javascript"></script>
    <script src="assets/js/tree/jquery.treeview.js" type="text/javascript"></script>


    <script src="assets/js/tree/tabelizer/jquery-ui-1.10.4.custom.min.js"></script>
    <script src="assets/js/tree/tabelizer/jquery.tabelizer.js"></script>

    <script src="assets/js/tree/treetable/vendor/jquery-ui.js"></script>
    <script src="assets/js/tree/treetable/javascripts/src/jquery.treetable.js"></script>

    <script type="text/javascript">
        $('#drag-and-drop-zone').dmUploader({
            url: '/assets/js/upload/demos/upload.php',
            dataType: 'json',
            allowedTypes: 'image/*',
            /*extFilter: 'jpg;png;gif',*/
            onInit: function () {
                $.danidemo.addLog('#demo-debug', 'default', 'Plugin initialized correctly');
            },
            onBeforeUpload: function (id) {
                $.danidemo.addLog('#demo-debug', 'default', 'Starting the upload of #' + id);

                $.danidemo.updateFileStatus(id, 'default', 'Uploading...');
            },
            onNewFile: function (id, file) {
                $.danidemo.addFile('#demo-files', id, file);
            },
            onComplete: function () {
                $.danidemo.addLog('#demo-debug', 'default', 'All pending tranfers completed');
            },
            onUploadProgress: function (id, percent) {
                var percentStr = percent + '%';

                $.danidemo.updateFileProgress(id, percentStr);
            },
            onUploadSuccess: function (id, data) {
                $.danidemo.addLog('#demo-debug', 'success', 'Upload of file #' + id + ' completed');

                $.danidemo.addLog('#demo-debug', 'info', 'Server Response for file #' + id + ': ' + JSON.stringify(data));

                $.danidemo.updateFileStatus(id, 'success', 'Upload Complete');

                $.danidemo.updateFileProgress(id, '100%');
            },
            onUploadError: function (id, message) {
                $.danidemo.updateFileStatus(id, 'error', message);

                $.danidemo.addLog('#demo-debug', 'error', 'Failed to Upload file #' + id + ': ' + message);
            },
            onFileTypeError: function (file) {
                $.danidemo.addLog('#demo-debug', 'error', 'File ' + file.name + ' cannot be added: must be an image');
            },
            onFileSizeError: function (file) {
                $.danidemo.addLog('#demo-debug', 'error', 'File ' + file.name + ' cannot be added: size excess limit');
            },
            /*onFileExtError: function(file){
             $.danidemo.addLog('#demo-debug', 'error', 'File /'' + file.name + '/' has a Not Allowed Extension');
             },*/
            onFallbackMode: function (message) {
                $.danidemo.addLog('#demo-debug', 'info', 'Browser not supported(do something else here!): ' + message);
            }
        });
    </script>


    <script>
        Dropzone.options.myDropzone = {
            paramName: "file",

            // Prevents Dropzone from uploading dropped files immediately
            // autoProcessQueue: false,

            /*init: function() {
             var submitButton = document.querySelector("#submit-all")
             myDropzone = this; // closure

             submitButton.addEventListener("click", function() {
             myDropzone.processQueue(); // Tell Dropzone to process all queued files.
             });

             // You might want to show the submit button only when
             // files are dropped here:
             this.on("addedfile", function() {
             // Show submit button here and/or inform user to click it.
             });

             }*/
        };
    </script>


    <script type="text/javascript">
        $(function () {
            $("#browser, #browser2").treeview({
                animated: "fast",
                collapsed: false,
                unique: true,
                persist: "cookie",
                toggle: function () {
                    window.console && console.log("%o was toggled", this);
                }
            });
        });
    </script>

    <script>
        $("#example-advanced").treetable({
            expandable: true,
            onNodeExpand: function () {
                var node = this;
                //alert("expand:"+this);
                alert(node.id);

                var str = "<tr data-tt-id=\"10\" data-tt-parent-id=\"1\" data-tt-branch=\"false\" class=\"leaf collapsed selected\" style=\"display: table-row;\"><td><span class=\"indenter\" style=\"padding-left: 38px;\"></span><span class=\"file ui-draggable\"></span>test.csv</td><td>(test.csv</td><td><a href=\"#\" class=\"del\">删除</a> <a href=\"#\" class=\"add\">添加子节点</a></td></tr>";
                $("#example-advanced").treetable("loadBranch", node, str);
            },
            onInitialized: function () {
                var node = $("#example-advanced").treetable("node", 1);
                //alert("initialized!"+node.id);
                $.ajax({
                    async: false,
                    dataType: "json",
                    url: "/files"
                }).done(function (html) {
                    var rows = $(html).filter("tr");
                    //alert(html);
                    // table.treetable("loadBranch", node, rows);

                    var str = '';
                    $.each(html, function (i, item) {
                        // alert("item.id"+item.id);

                        /*  str += '<tr data-tt-id="' + item.id + '" data-tt-parent-id="'+id+'"  class="leaf collapse">' +*/
                        str += '<tr data-tt-id="' + item.id + '" data-tt-parent-id="' + item.creater + '"  data-tt-branch="' + (item.leaf ? "false" : "true") + '">' +
                                '<td>' +
                                (item.leaf ? '<span class="file"></span>' : '<span class="folder"></span>') +
                                item.name + '</td>' +
                                '<td>(' + item.name + '</td>)' +
                                '<td><a href="#" class="del">删除</a> <a href="#" class="add">添加子节点</a></td>' +
                                '</tr>';
                    });
                    //var node = $("#example-basic").treetable("node",id);
                    //alert(node.id);

                    $("#example-advanced").treetable("loadBranch", node, str);
                });
            }
        });

        $("#example-basic-static").treetable();

        $("#example-basic-expandable").treetable({
            expandable: true
        });

        $("#example-advanced").treetable({
            expandable: true
        });

        // Highlight selected row
        $("#example-advanced tbody").on("mousedown", "tr", function () {
            $(".selected").not(this).removeClass("selected");
            $(this).toggleClass("selected");
        });

        // Drag & Drop Example Code
        $("#example-advanced .file, #example-advanced .folder").draggable({
            helper: "clone",
            opacity: .75,
            refreshPositions: true, // Performance?
            revert: "invalid",
            revertDuration: 300,
            expandable: true,
            scroll: true
        });

        $("#example-advanced .folder").each(function () {
            $(this).parents("#example-advanced tr").droppable({
                accept: ".file, .folder",
                drop: function (e, ui) {
                    var droppedEl = ui.draggable.parents("tr");
                    alert(droppedEl.data("ttId"));
                    $("#example-advanced").treetable("move", droppedEl.data("ttId"), $(this).data("ttId"));
                },
                hoverClass: "accept",
                over: function (e, ui) {
                    var droppedEl = ui.draggable.parents("tr");
                    if (this != droppedEl[0] && !$(this).is(".expanded")) {
                        $("#example-advanced").treetable("expandNode", $(this).data("ttId"));
                    }
                }
            });
        });

        $("form#reveal").submit(function () {
            var nodeId = $("#revealNodeId").val()

            try {
                $("#example-advanced").treetable("reveal", nodeId);
            } catch (error) {
                alert(error.message);
            }

            return false;
        });
    </script>

    <script>
        $(document).ready(function () {
            var table1 = $('#table1').tabelize({
                /*onRowClick : function(){
                 alert('test');
                 }*/
                fullRowClickable: true,
                onReady: function () {
                    console.log('ready');
                },
                onBeforeRowClick: function () {
                    console.log('onBeforeRowClick');
                },
                onAfterRowClick: function () {
                    console.log('onAfterRowClick');
                },
            });
        });
    </script>

</div>


